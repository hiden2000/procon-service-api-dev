
# Procon Web Service Backend Documentation

このプロジェクトでは，競技プログラミングの問題を共有し，解答するためのWebサービスのバックエンド部分の開発を行っている．しかしながら，プログラミング教育や競技プログラミングコミュニティにおいて，ユーザーが問題を投稿，解答し，互いにフィードバックを交換できるプラットフォームの基盤のようなものを作成するよりも，現時点の段階では，サービス開発の基盤について個人で学ぶことを目的としている．そのため，実際にサービスとして機能させる分には，不完全な部分が多く残る．

## 技術スタック

このプロジェクトは，以下の技術を使用している：

- **言語**: Go (バックエンドのAPIサーバー)
- **データベース**: MySQL, Redis (セッション管理とキャッシュ)
- **インフラ**: Dockerを使用したコンテナ化，将来的にはAWSやGoogle Cloud Platformにデプロイ予定
- **その他のツール**: WebSocketを使用したリアルタイム通信

## アーキテクチャ

バックエンドは，RESTful APIを提供するGo言語で書かれたサーバー，問題と解答のデータを管理するMySQLデータベース，ユーザー認証とセッション管理のためのRedis，リアルタイム通信のためのWebSocketサーバーから構成される．

- `/api/problems/`: 問題管理
- `/api/solutions/`: 解答管理
- `/api/users/`: ユーザー管理
- `/api/websocket/`: リアルタイムの解答判定とフィードバック

## 開発状況と今後の計画

現在，このプロジェクトはバックエンドAPIの開発段階にある．

フロントエンドは保留中であり，APIの機能はPostmanやcurlを使用してテストすることができるようにする予定である．

将来的には，このバックエンドをクラウドプラットフォームにデプロイし，フロントエンドの開発を開始することを検討している．

## 起動方法

プロジェクトのルートディレクトリで以下のコマンドを実行して，ローカルで，アプリケーションのコンテナを起動できる．

```bash
docker-compose --env-file .env -f docker/docker-compose.yaml up --build
```

このプロジェクトは開発途中であり，幾多も修正の余地があるため，現在も修正途中である．


## dockerにおけるサービス内部で作成しているコンテナの説明

ローカル上でサービスを起動するにあたって，docker-compose を用いて，複数のコンテナを統合して一つのサービスとして動かしている．

以下はそれぞれのコンテナの役割とその概要である．詳しい統合関係に関する情報は`docker`フォルダを参照する．

### web-serverコンテナ：
外部からのリクエストを受け付け，基本的なAPIの処理を担当し，必要な処理を行うコンテナ．外部に対して，公開インターフェースを持つ，唯一のコンテナとなる．

### dbコンテナ：
サービスを行うにあたって，必要な情報を保存するための，MySQLデータベースを提供するためのコンテナ．

### judge-serverコンテナ：
web-server側から送られてきたソースコードを解析して，そのそのコードを，dockerを用いて作られたサンドボックス環境内で実行するためのコンテナ．ジャッジにあたって，web-serverコンテナの他に，後述のminioコンテナとも通信を行い，プログラムジャッジのために用いられる入出力データを必要に応じて参照する．

### minioコンテナ：
プログラミング問題に対する，ユーザーからの提出コードの正誤を判定する際に，一般に，複数の入出力ファイルを用意しておき，プログラムに入力ファイルを入れたときに得られるアウトプットが，対応する出力ファイルの内容に等しいかでプログラムを判定する．このコンテナでは，その入出力ファイルをminioコンテナに保存し，必要に応じて，web-serverコンテナやjudge-serverコンテナに提供するインターフェースを提供する．

### create-bucketコンテナ：
このコンテナ自体は特別な役割を果たさないが，minioコンテナの初期化設定に用いるのみである．

### ridisコンテナ：
後ほどソースコードの説明の際にも述べるが，このridisコンテナでは，サービスを利用するユーザーの認証をJWT Tokenを用いて管理する．それによって，ユーザーに提供するいくつかの機能に対しては，正式にアカウントを登録し，なおかつサービスに本人であると認証されたものに対してしか提供しないような機構を持たせる．